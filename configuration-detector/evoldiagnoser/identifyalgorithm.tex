\begin{figure}[t]

\textbf{Auxiliary methods}: 

\quad getPredicates($\mathit{T}$): return all predicates in the execution trace $\mathit{T}$.

\textbf{Input}: two execution traces: $\mathit{T_{old}}$ and $T_{new}$

\quad the instruction map: $\mathit{stmtMap}$ produced by Figure~\ref{fig:matching}
\todo{Figure~\ref{fig:matching} is for 2 specific methods and is called
  many times.  I think you mean the union of all calls for matched methods.}

\quad a threshold: $\delta$ (default value: 0.1, used in our experiments)\\
\textbf{Output}: all pairs of behaviorally-deviated predicates between two versions, and their deviation degree\\
\vspace{-4mm}%
identifyDeviatedPredicates($\mathit{T_{old}}$, $\mathit{T_{new}}$, $\mathit{stmtMap}$)\\
\begin{algorithmic}[1]
\STATE $\mathit{predMap}$ $\leftarrow$ new Map$\langle$$\langle$Predicate, Predicate$\rangle$, Float$\rangle$
\FOR{each predicate $\mathit{p_{old}}$ in getPredicates($\mathit{T_{old}}$)}
\STATE $\mathit{v}$ $\leftarrow$ $\phi$($\mathit{p_{old}}$, $\mathit{T_{old}}$)
\STATE $\mathit{p_{new}}$ $\leftarrow$ $\mathit{stmtMap}$[$\mathit{p_{old}}$]
\IF{$\mathit{p_{new}}$ $\neq$ $\mathit{null}$}
\STATE $\mathit{v}$ $\leftarrow$ $|\phi$($\mathit{p_{old}}$, $\mathit{T_{old}}$) - $\phi$($\mathit{p_{new}}$, $\mathit{T_{new}}$)$|$
\ENDIF
\IF{$\mathit{v}$ $\geq$ $\delta$}
\STATE $\mathit{predMap}$.put($\langle$$\mathit{p_{old}}$, $p_{new}$$\rangle$, $\mathit{v}$)
\ENDIF
\ENDFOR
\FOR{each predicate $\mathit{p_{new}}$ in getPredicates($\mathit{T_{new}}$)}
\IF{$\neg$$\mathit{stmtMap}$.values().contain($\mathit{p_{new}}$)}
\STATE $\mathit{v}$ $\leftarrow$ $\phi$($\mathit{p_{new}}$, $\mathit{T_{new}}$)
\IF{$\mathit{v}$ $\geq$ $\delta$}
\STATE $\mathit{predMap}$.put($\langle$$\mathit{null}$, $p_{new}$$\rangle$, $\mathit{v}$)
\ENDIF
\ENDIF
\ENDFOR
\RETURN $\mathit{predMap}$
\end{algorithmic}
\vspace{-2mm}
\caption{Algorithm for identifying behavioral-deviated
predicates. The $\phi$ function is defined in Section~\ref{sec:identify_diff}.
\label{fig:identify}
}
\end{figure}

%  LocalWords:  getPredicates identifyDeviatedPredicates stmtMap predMap
